\chapter{Camera}

\section{Camera Setup}

  A virtual camera has the following properties

  \begin{enumerate}
    \item Eye point, i.e. \textbf{positions}, $ e $
    \item Look at point $ l $
    \item Up vector $ up $
    \item View plane distance $ d $
    \item View direction: $ l - e $
    \item This system will break when view direction and up vector are
    \textbf{paralle} or \textbf{antiparallel}, i.e. the angle between them is
    $ 0\deg $ or $ 180\deg $, i.e. a dot product of $ 0 $
  \end{enumerate}

  From which we construct the camera frame (world space)
  \begin{itemize}
    \item \textbf{Origin}: $ e $
    \item \textbf{Orthonormal basis (ONB)}: $ w, u, v $
    \begin{align}
      w &= \frac{\left( e - l \right)}{\left\Vert e - l \right\Vert} \\
      u &= \frac{\left( up \times w \right)}{\left\Vert up \times w \right\Vert} \\
      v &= w \times u
    \end{align}

    \item $ u $ is parallel to pixel row;
    \item $ v $ is parallel to pixel columns;
  \end{itemize}

  We construct convert pixel position to a
  \textbf{screen space position}
  \begin{align}
    p_{v} &= \left( x_{v}, y_{v}, z_{v} \right) \\
    p_{v} &=
    \left(
      s\left( c - \frac{h_{res}}{2} + \delta_{x} \right),
      s\left( r - \frac{v_{res}}{2} + \delta_{y} \right),
      -d
    \right)
  \end{align}

  \begin{itemize}
    \item $ c, r $: screen space coordinates of pixels; $ c $ is the column,
    $ r $ is the row
    \begin{itemize}
      \item $ \left( 0, 0 \right) $ is at the bottom left of an image
    \end{itemize}

    \item $ s $: pixel extent; pixel length in world space
    \item $ x_{v}, y_{v}, z_{v} $: coordinate in screen space of the pixel center
    \item $ \delta_{x}, \delta_{y} $: subpixel offset from sampling
  \end{itemize}

  From which we can convert a screen-space position to a world-space position
  \begin{equation}
    p_{w} = u x_{v} + v y_{v} + w z_{v}
  \end{equation}

  Using the world-space pixel position and the world-space eye position,
  we can construct rays.

\section{Orthographic}

  \begin{align}
    O &= \left( x_{w}, y_{w}, z_{w} \right) \\
    d &= \left( 0, 0, -1 \right)
  \end{align}

  Rays have the same direction as negative-z and use their world space
  coordinates as origins

\section{Perspective}

  \begin{align}
    e &= \left( x_{w}, y_{w}, z_{w} \right) \\
    O &= e  \\
    d &= \left( x_{w}, y_{w}, z_{w} \right) - e
  \end{align}

  \begin{itemize}
    \item $ d $: distance between the eye point and the \say{window}
    \item Distortion is a feature not a bug. To reduce distortion, move
    the eye point away from objects
  \end{itemize}
